using System;
using System.IO;
using Microsoft.Extensions.Hosting;

namespace backend.Services;

public static class VikendAkcijeAssets
{
    private const string PdfFileName = "vikend-akcije-import-uputstvo.pdf";
    private const string XlsxFileName = "vikend-akcije-sablon.xlsx";

    private static readonly byte[] PdfBytes = Convert.FromBase64String(@"
JVBERi0xLjQKMSAwIG9iago8PCAvVHlwZSAvQ2F0YWxvZyAvUGFnZXMgMiAwIFIgPj4KZW5kb2Jq
CjIgMCBvYmoKPDwgL1R5cGUgL1BhZ2VzIC9Db3VudCAxIC9LaWRzIFszIDAgUl0gPj4KZW5kb2Jq
CjMgMCBvYmoKPDwgL1R5cGUgL1BhZ2UgL1BhcmVudCAyIDAgUiAvTWVkaWFCb3ggWzAgMCA2MTIg
NzkyXSAvQ29udGVudHMgNCAwIFIgL1Jlc291cmNlcyA8PCAvRm9udCA8PCAvRjEgNSAwIFIgPj4g
Pj4gPj4KZW5kb2JqCjQgMCBvYmoKPDwgL0xlbmd0aCA3ODkgPj4Kc3RyZWFtCkJUCi9GMSAxOCBU
Zgo1MCA3ODAgVGQKKFZpa2VuZCBha2NpamUgLSB1cHV0c3R2byB6YSBpbXBvcnQpIFRqCi9GMSAx
MiBUZgowIC0yNiBUZAooS29yaXN0aXRlIHp2YW5pY25pIEV4Y2VsIHNhYmxvbiBpIHNhY3V2YWp0
ZSBnYSB1IC54bHN4IGZvcm1hdHUuKSBUagowIC0xOCBUZAooT2JhdmV6bmEgcG9samE6IFNJRlJB
IEFSVElLTEEsIE5BWklWLCBTVEFUVVMsIEFLQ0lKU0tBIE1QQy4pIFRqCjAgLTE4IFRkCihEb2Rh
dG5hIHBvbGphIFwoQmFyIGtvZCwgRG9iYXZsamFjLCBBUyBTQS9NTy9CTCwgT3BpcywgWmFsaWhh
XCkgcG9tYXp1IGl6dmplc3RhamltYS4pIFRqCjAgLTE4IFRkCihOZSBicmlzaXRlIHphZ2xhdmxq
ZSBrb2xvbmEgaSBuZSBvc3RhdmxqYWp0ZSBwcmF6bmUgcmVkb3ZlIGl6bWVkanUgc3RhdmtpLikg
VGoKMCAtMTggVGQKKFZyaWplZG5vc3RpIGJyb2pldmEgcGlzaXRlIHNhIHRhY2tvbSBpbGkgemFy
ZXpvbSwgYmV6IG5lcG90cmVibmloIHJhem1ha2EuKSBUagowIC0xOCBUZAooQWtvIGFydGlrYWwg
bmVtYSB6YWxpaGUsIHVwaXNpdGUgMCBrYWtvIGJpIGl6dmplc3Rhamkgb3N0YWxpIGtvbnppc3Rl
bnRuaS4pIFRqCjAgLTE4IFRkCihTdmFrYSBzaWZyYSBhcnRpa2xhIG1vcmEgYml0aSBqZWRpbnN0
dmVuYSB1bnV0YXIgZmFqbGEgXChiZXogZHVwbGlrYXRhXCkuKSBUagowIC0xOCBUZAooTmFrb24g
dXNwamVzbm9nIGltcG9ydGEgcHJvdmplcml0ZSBsaXN0dSBzdGF2a2kgcHJpamUgbmVnbyBqZSBv
Ymphdml0ZSBwcm9kYXZuaWNhbWEuKSBUagowIC0xOCBUZApFVAplbmRzdHJlYW0KZW5kb2JqCjUg
MCBvYmoKPDwgL1R5cGUgL0ZvbnQgL1N1YnR5cGUgL1R5cGUxIC9CYXNlRm9udCAvSGVsdmV0aWNh
ID4+CmVuZG9iagp4cmVmCjAgNgowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDAwMDkgMDAwMDAg
biAKMDAwMDAwMDA1OCAwMDAwMCBuIAowMDAwMDAwMTE1IDAwMDAwIG4gCjAwMDAwMDAyNDEgMDAw
MDAgbiAKMDAwMDAwMTA4MSAwMDAwMCBuIAp0cmFpbGVyCjw8IC9TaXplIDYgL1Jvb3QgMSAwIFIg
Pj4Kc3RhcnR4cmVmCjExNTEKJSVFT0Y=");

    private static readonly byte[] TemplateBytes = Convert.FromBase64String(@"
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
bFBLBQYAAAAABQAFAEUBAACjBQAAAAA=");

    public static void EnsureAssets(IWebHostEnvironment environment)
    {
        var root = environment.WebRootPath ?? "wwwroot";
        Directory.CreateDirectory(root);

        var pdfPath = Path.Combine(root, PdfFileName);
        if (!File.Exists(pdfPath))
        {
            File.WriteAllBytes(pdfPath, PdfBytes);
        }

        var templatePath = Path.Combine(root, XlsxFileName);
        if (!File.Exists(templatePath))
        {
            File.WriteAllBytes(templatePath, TemplateBytes);
        }
    }
}
