using System;
using System.IO;
using Microsoft.Extensions.Hosting;

namespace backend.Services;

public static class VikendAkcijeAssets
{
    private const string PdfFileName = "vikend-akcije-import-uputstvo.pdf";
    private const string XlsxFileName = "vikend-akcije-sablon.xlsx";

    private static readonly byte[] PdfBytes = Convert.FromBase64String(@"
JVBERi0xLjQKMSAwIG9iago8PCAvVHlwZSAvQ2F0YWxvZyAvUGFnZXMgMiAwIFIgPj4KZW5kb2Jq
CjIgMCBvYmoKPDwgL1R5cGUgL1BhZ2VzIC9Db3VudCAxIC9LaWRzIFszIDAgUl0gPj4KZW5kb2Jq
CjMgMCBvYmoKPDwgL1R5cGUgL1BhZ2UgL1BhcmVudCAyIDAgUiAvTWVkaWFCb3ggWzAgMCA1OTUg
ODQyXSAvQ29udGVudHMgNCAwIFIgL1Jlc291cmNlcyA8PCAvRm9udCA8PCAvRjEgNSAwIFIgPj4g
Pj4gPj4KZW5kb2JqCjQgMCBvYmoKPDwgL0xlbmd0aCA2MjAgPj4Kc3RyZWFtCkJUCi9GMSAxOCBU
Zgo3MiA3ODAgVGQKKFZpa2VuZCBha2NpamUgLSB1cHV0c3R2byB6YSBpbXBvcnQpIFRqCi9GMSAx
MiBUZgowIC0yNCBUZAooT2JhdmV6bmUga29sb25lIHUgRXhjZWwgZmFqbHU6IMWgSUZSQSBBUlRJ
S0xBLCBOQVpJViwgQkFSIEtPRCwgRE9CQVZMSkHEjCwgQVMgU0EsIEFTIE1PLCBBUyBCTCwgT1BJ
UywgU1RBVFVTLCBBS0NJSlNLQSBNUEMuKSBUagowIC0yNCBUZAooVnJpamVkbm9zdGkgdSBrb2xv
bmkgQUtDSUpTS0EgTVBDIG1vcmFqdSBiaXRpIG51bWVyacSNa2UgXChtb8W+ZXRlIGtvcmlzdGl0
aSB0YcSNa3UgaWxpIHphcmV6XCkuKSBUagowIC0yNCBUZAooUG9samEgxaBJRlJBIEFSVElLTEEs
IE5BWklWIGkgU1RBVFVTIHN1IG9iYXZlem5hIHphIHN2YWtpIHJlZCwgZHVwbGlrYXRpIMWhaWZy
ZSBuaXN1IGRvenZvbGplbmkuKSBUagowIC0yNCBUZAooUHJhem5pIHJlZG92aSBzZSBwcmVza2HE
jXUsIGEgc3ZlIGRvZGF0bmUga29sb25lIMSHZSBiaXRpIGlnbm9yaXNhbmUuKSBUagowIC0yNCBU
ZAooUHJlcG9ydWthOiBwcnZpIHJlZCB1IC54bHN4IGZhamx1IG5la2EgYnVkZSBoZWFkZXIgc2Eg
Z29yZSBuYXZlZGVuaW0gbmF6aXZpbWEga29sb25hLikgVGoKRVQKZW5kc3RyZWFtCmVuZG9iago1
IDAgb2JqCjw8IC9UeXBlIC9Gb250IC9TdWJ0eXBlIC9UeXBlMSAvQmFzZUZvbnQgL0hlbHZldGlj
YSA+PgplbmRvYmoKeHJlZgowIDYKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDA5IDAwMDAw
IG4gCjAwMDAwMDAwNTggMDAwMDAgbiAKMDAwMDAwMDExNSAwMDAwMCBuIAowMDAwMDAwMjQxIDAw
MDAwIG4gCjAwMDAwMDA5MTEgMDAwMDAgbiAKdHJhaWxlcgo8PCAvU2l6ZSA2IC9Sb290IDEgMCBS
ID4+CnN0YXJ0eHJlZgo5ODEKJSVFT0Y=");

    private static readonly byte[] TemplateBytes = Convert.FromBase64String(@"
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
bFBLBQYAAAAABQAFAEUBAACjBQAAAAA=");

    public static void EnsureAssets(IWebHostEnvironment environment)
    {
        var root = environment.WebRootPath ?? "wwwroot";
        Directory.CreateDirectory(root);

        var pdfPath = Path.Combine(root, PdfFileName);
        if (!File.Exists(pdfPath))
        {
            File.WriteAllBytes(pdfPath, PdfBytes);
        }

        var templatePath = Path.Combine(root, XlsxFileName);
        if (!File.Exists(templatePath))
        {
            File.WriteAllBytes(templatePath, TemplateBytes);
        }
    }
}
